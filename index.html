<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Squid Game Calculator</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --bg:#0f1117;--surface:#1a1d27;--card:#222636;--border:#2e3348;
  --text:#e0e0e8;--dim:#8888a0;--accent:#6c8cff;--green:#4cdb8a;
  --red:#ff6b6b;--yellow:#ffd166;--cyan:#66e0ff;
}
body{font-family:'SF Mono','Fira Code','Cascadia Code',monospace;background:var(--bg);color:var(--text);min-height:100vh;padding:0 0 40px}
.header{background:linear-gradient(135deg,#1a1040,#0f1117 70%);border-bottom:1px solid var(--border);padding:20px;text-align:center}
.header h1{font-size:1.4rem;color:var(--accent);margin-bottom:4px}
.header p{font-size:0.8rem;color:var(--dim)}
.payout-bar{display:flex;flex-wrap:wrap;justify-content:center;gap:6px 12px;margin-top:10px;font-size:0.72rem;color:var(--dim)}
.payout-bar span{white-space:nowrap}
.payout-bar .thr{color:var(--yellow)}

.tabs{display:flex;gap:2px;padding:8px 16px;background:var(--surface);border-bottom:1px solid var(--border);position:sticky;top:0;z-index:10}
.tab{flex:1;padding:10px;border:none;background:transparent;color:var(--dim);cursor:pointer;font-family:inherit;font-size:0.85rem;border-radius:6px;transition:all .15s;text-align:center}
.tab:hover{background:var(--card);color:var(--text)}
.tab.active{background:var(--accent);color:#fff}

.content{max-width:800px;margin:0 auto;padding:16px}
.panel{display:none}.panel.active{display:block}
.card{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:14px}
.card h2{font-size:1rem;color:var(--accent);margin-bottom:10px}
.card h3{font-size:0.9rem;color:var(--cyan);margin:14px 0 6px}

/* Form */
.form-row{display:flex;gap:12px;align-items:flex-end;flex-wrap:wrap;margin-bottom:14px}
.form-group{display:flex;flex-direction:column;gap:3px}
.form-group label{font-size:0.72rem;color:var(--dim)}
.form-group .hint{font-size:0.68rem;color:var(--dim);margin-top:2px}
input[type=number]{background:var(--bg);border:1px solid var(--border);color:var(--text);padding:8px 10px;border-radius:6px;font-family:inherit;font-size:0.9rem;width:80px}
input[type=text]{background:var(--bg);border:1px solid var(--border);color:var(--text);padding:8px 10px;border-radius:6px;font-family:inherit;font-size:0.9rem;width:100%}
input:focus{outline:none;border-color:var(--accent)}
.calc-btn{background:var(--accent);color:#fff;border:none;padding:10px 24px;border-radius:6px;cursor:pointer;font-family:inherit;font-size:0.9rem;transition:opacity .15s;white-space:nowrap}
.calc-btn:hover{opacity:0.85}
.calc-btn:disabled{opacity:0.5;cursor:not-allowed}
.validation{font-size:0.75rem;margin-top:6px;min-height:1.2em}
.validation.ok{color:var(--green)}
.validation.err{color:var(--red)}
.validation.warn{color:var(--yellow)}

/* Results */
.results{margin-top:16px}
.result-hero{text-align:center;padding:20px;background:var(--bg);border-radius:8px;margin-bottom:12px}
.result-hero .label{font-size:0.8rem;color:var(--dim);margin-bottom:4px}
.result-hero .value{font-size:2rem;font-weight:bold}
.result-hero .value.pos{color:var(--green)}
.result-hero .value.neg{color:var(--red)}
.result-hero .interp{font-size:0.75rem;color:var(--dim);margin-top:6px}
.result-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-bottom:12px}
.result-cell{background:var(--bg);border-radius:6px;padding:10px;text-align:center}
.result-cell .label{font-size:0.7rem;color:var(--dim)}
.result-cell .val{font-size:1rem;margin-top:2px;font-variant-numeric:tabular-nums}
.result-cell .val.pos{color:var(--green)}
.result-cell .val.neg{color:var(--red)}
.penalty-box{background:rgba(255,107,107,0.08);border:1px solid rgba(255,107,107,0.2);border-radius:6px;padding:10px;margin-bottom:10px;font-size:0.8rem}
.penalty-box .title{color:var(--red);font-weight:bold;margin-bottom:4px}
.threshold-note{background:rgba(255,209,102,0.08);border:1px solid rgba(255,209,102,0.2);border-radius:6px;padding:10px;margin-bottom:10px;font-size:0.8rem;color:var(--yellow)}

/* Reference table */
.ref-table{width:100%;border-collapse:collapse;font-size:0.78rem;margin-top:8px}
.ref-table th{text-align:left;color:var(--dim);padding:6px 8px;border-bottom:1px solid var(--border);font-weight:normal;white-space:nowrap}
.ref-table td{padding:6px 8px;border-bottom:1px solid rgba(46,51,72,0.4);font-variant-numeric:tabular-nums}
.ref-table .num{text-align:right}
.ref-table .pos{color:var(--green)}
.ref-table .neg{color:var(--red)}
.ref-table .thr{color:var(--yellow)}
.ref-table tr:hover td{background:rgba(108,140,255,0.05)}
.rule{padding:6px 0;font-size:0.8rem;border-bottom:1px solid rgba(46,51,72,0.3)}
.rule b{color:var(--cyan)}

@media(max-width:600px){
  .form-row{flex-direction:column;align-items:stretch}
  input[type=number]{width:100%}
  .result-grid{grid-template-columns:1fr 1fr}
  .ref-table{font-size:0.7rem}
  .ref-table th,.ref-table td{padding:4px 5px}
}
</style>
</head>
<body>

<div class="header">
  <h1>Squid Game Calculator</h1>
  <p>9 players &middot; 12 squids &middot; $100/squid &middot; Zero-sum with penalty</p>
  <div class="payout-bar">
    <span>1=$100</span><span>2=$200</span>
    <span class="thr">3=$600 (2x)</span><span>4=$800</span>
    <span class="thr">5=$2.0k (4x)</span><span>6=$2.4k</span>
    <span class="thr">7=$4.2k (6x)</span><span>8=$4.8k</span>
    <span class="thr">9=$7.2k (8x)</span><span>10=$8.0k</span>
    <span>11=$8.8k</span><span>12=$9.6k</span>
  </div>
</div>

<div class="tabs">
  <button class="tab active" onclick="switchTab('calc')">Hand Value Calculator</button>
  <button class="tab" onclick="switchTab('ref')">Quick Reference</button>
</div>

<div class="content">

<!-- TAB 1: CALCULATOR -->
<div class="panel active" id="panel-calc">
  <div class="card">
    <h2>What is this hand worth?</h2>
    <p style="color:var(--dim);font-size:0.78rem;margin-bottom:12px">
      Enter your game state. Monte Carlo simulates 200k games with early termination.
    </p>

    <div class="form-row">
      <div class="form-group">
        <label>Your Squids</label>
        <input type="number" id="in-my" value="0" min="0" max="12" oninput="validate()">
      </div>
      <div class="form-group">
        <label>Hands Remaining</label>
        <input type="number" id="in-remain" value="7" min="1" max="11" oninput="validate()">
      </div>
      <div class="form-group">
        <label style="display:flex;align-items:center;gap:6px;cursor:pointer;font-size:0.78rem;color:var(--text)">
          <input type="checkbox" id="in-double" onchange="validate()"> Double hand (+2 squids)
        </label>
      </div>
    </div>

    <div class="form-group" style="margin-bottom:12px">
      <label>Opponent Squid Counts</label>
      <input type="text" id="in-opp" value="3, 1, 1" placeholder="e.g. 3, 1, 1  (unlisted = 0)" oninput="validate()">
      <div class="hint">Comma-separated. Enter counts for opponents who have squids; rest assumed 0.</div>
    </div>

    <div class="validation" id="validation"></div>

    <div style="display:flex;gap:10px;align-items:center;margin-top:8px">
      <button class="calc-btn" id="calc-btn" onclick="runCalc()">CALCULATE</button>
      <span id="calc-status" style="font-size:0.75rem;color:var(--dim)"></span>
    </div>

    <div class="results" id="results" style="display:none"></div>
  </div>

  <div class="card">
    <h2>How it works</h2>
    <p style="font-size:0.78rem;color:var(--dim);line-height:1.5">
      <b style="color:var(--text)">Hand Value</b> = E[your net if you WIN] - E[your net if you LOSE]<br><br>
      <b style="color:var(--text)">Game ends</b> when exactly 1 player has 0 squids, or after all hands.<br>
      <b style="color:var(--green)">Winners</b> (end with squids): earn payout &times; (# players at 0)<br>
      <b style="color:var(--red)">Losers</b> (end with 0 squids): pay sum of all opponents' payouts<br><br>
      The penalty for ending at 0 is typically <b style="color:var(--red)">$1.6k-$3.0k</b>.
      The first squid is enormously valuable — it's about avoiding ruin.
    </p>
  </div>
</div>

<!-- TAB 2: REFERENCE -->
<div class="panel" id="panel-ref">
  <div class="card">
    <h2>Hand Value by Squid Count</h2>
    <p style="color:var(--dim);font-size:0.78rem;margin-bottom:10px">
      Average hand value across common game situations at 1/9 win rate.
    </p>
    <table class="ref-table">
      <tr><th>Your Sq</th><th class="num">Avg Value</th><th class="num">Range</th><th>Key Insight</th></tr>
      <tr><td>0</td><td class="num pos">$1.4k</td><td class="num">$1.3k-$1.5k</td><td>Avoiding $1.8k+ penalty is huge</td></tr>
      <tr><td>1</td><td class="num pos">$700</td><td class="num">$700</td><td>Escaped zero, building toward 2x</td></tr>
      <tr><td class="thr">2</td><td class="num pos">$1.2k</td><td class="num">$1.1k-$1.4k</td><td class="thr">One from 2x threshold</td></tr>
      <tr><td>3</td><td class="num pos">$2.0k</td><td class="num">$2.0k-$2.1k</td><td>At 2x, building toward 4x</td></tr>
      <tr><td class="thr">4</td><td class="num pos">$4.2k</td><td class="num">$3.6k-$5.2k</td><td class="thr">One from 4x — huge jump</td></tr>
      <tr><td>5</td><td class="num pos">$3.8k</td><td class="num">$3.8k</td><td>At 4x, chasing 6x jackpot</td></tr>
      <tr><td class="thr">6</td><td class="num pos">$8.2k</td><td class="num">$7.5k-$8.8k</td><td class="thr">One from 6x — THE JACKPOT</td></tr>
    </table>
  </div>

  <div class="card">
    <h2>20 Common Scenarios</h2>
    <p style="color:var(--dim);font-size:0.78rem;margin-bottom:10px">
      Pre-computed at 1/9 win rate with 800k Monte Carlo sims. Early termination enabled.
    </p>
    <table class="ref-table" id="scenarios-table">
      <tr><th>#</th><th>Phase</th><th>You</th><th>Opps</th><th>Left</th><th class="num">Value</th><th class="num">Baseline</th></tr>
    </table>
  </div>

  <div class="card">
    <h2>Key Rules</h2>
    <div class="rule"><b>1.</b> Game ends when exactly <b>1 player has 0 squids</b> (early termination) or after all hands</div>
    <div class="rule"><b>2.</b> At 0 squids, your baseline EV is <b style="color:var(--red)">NEGATIVE</b> — the first squid is worth $1.3k-$1.5k because it saves you from the $1.8k+ loser penalty</div>
    <div class="rule"><b>3.</b> Threshold squids (&rarr;3, &rarr;5, &rarr;7) are <b>2-3x more valuable</b> than non-threshold squids</div>
    <div class="rule"><b>4.</b> Squid value <b>increases</b> as the game progresses — fewer hands means each matters more</div>
    <div class="rule"><b>5.</b> At 6 squids late game, a single hand is worth <b style="color:var(--green)">$7.5k-$8.8k</b></div>
    <div class="rule"><b>6.</b> Opponent concentration helps — squids on few opponents means more at 0 means more payers</div>
  </div>

  <div class="card">
    <h2>Zero-Squid Penalty</h2>
    <table class="ref-table">
      <tr><th>#</th><th>Phase</th><th>Remain</th><th class="num">P(end@0)</th><th class="num">Avg Penalty</th><th class="num">Hand Value</th><th class="num">Baseline</th></tr>
      <tr><td>1</td><td>EARLY</td><td>7</td><td class="num">44.0%</td><td class="num neg">$2.0k</td><td class="num pos">$1.4k</td><td class="num neg">-$675</td></tr>
      <tr><td>4</td><td>EARLY</td><td>6</td><td class="num">49.5%</td><td class="num neg">$1.8k</td><td class="num pos">$1.3k</td><td class="num neg">-$711</td></tr>
      <tr><td>6</td><td>MID</td><td>5</td><td class="num">55.5%</td><td class="num neg">$2.0k</td><td class="num pos">$1.5k</td><td class="num neg">-$940</td></tr>
    </table>
    <p style="font-size:0.78rem;color:var(--dim);margin-top:8px">
      At 0 squids, there's a 44-56% chance of ending at 0 and paying the $1.8k-$2.0k penalty. Your baseline EV is deeply negative.
    </p>
  </div>
</div>

</div><!-- /content -->

<script>
// ═══════════════════════════════════════════════
// GAME CONSTANTS
// ═══════════════════════════════════════════════
const PAYOUTS = [0, 100, 200, 600, 800, 2000, 2400, 4200, 4800, 7200, 8000, 8800, 9600];
const N_SIMS = 200000;
const TOTAL_SQUIDS = 12;

function getPayout(n) { return PAYOUTS[Math.min(n, 12)]; }

function fmt(n) {
  if (n < 0) return '-$' + Math.abs(Math.round(n)).toLocaleString();
  return '$' + Math.round(n).toLocaleString();
}

// ═══════════════════════════════════════════════
// MONTE CARLO ENGINE (with early termination)
// ═══════════════════════════════════════════════
function computeNet(mySq, opp) {
  if (mySq > 0) {
    let zeros = 0;
    for (let i = 0; i < 8; i++) if (opp[i] === 0) zeros++;
    return getPayout(mySq) * zeros;
  } else {
    let sum = 0;
    for (let i = 0; i < 8; i++) sum += getPayout(opp[i]);
    return -sum;
  }
}

function checkGameEnd(mySq, opp) {
  let totalZeros = (mySq === 0) ? 1 : 0;
  for (let i = 0; i < 8; i++) if (opp[i] === 0) totalZeros++;
  return totalZeros === 1;
}

function simulate(mySq, oppArr, remaining, sqPerHand) {
  const nSims = N_SIMS;
  let sumW = 0, sumL = 0;
  let zeroL = 0, penL = 0;

  // Detect if double hand is in future (hand 1 not yet played)
  const dealt = mySq + oppArr.reduce((a,b) => a+b, 0);
  const doubleInFuture = (dealt < 2) && (sqPerHand < 2);

  const oppW = new Int32Array(8);
  const oppL = new Int32Array(8);

  for (let s = 0; s < nSims; s++) {
    for (let i = 0; i < 8; i++) { oppW[i] = oppArr[i]; oppL[i] = oppArr[i]; }

    let myW = mySq + sqPerHand;
    let myL = mySq;

    // Lose path: random opponent gets the squid(s)
    oppL[(Math.random() * 8) | 0] += sqPerHand;

    let endedW = checkGameEnd(myW, oppW);
    let endedL = checkGameEnd(myL, oppL);

    // Future hands — same randomness for both paths (variance reduction)
    for (let h = 0; h < remaining - 1; h++) {
      if (endedW && endedL) break;

      const futSq = (doubleInFuture && h === 0) ? 2 : 1;
      const w = (Math.random() * 9) | 0;

      if (!endedW) {
        if (w === 0) myW += futSq; else oppW[w-1] += futSq;
        if (checkGameEnd(myW, oppW)) endedW = true;
      }
      if (!endedL) {
        if (w === 0) myL += futSq; else oppL[w-1] += futSq;
        if (checkGameEnd(myL, oppL)) endedL = true;
      }
    }

    sumW += computeNet(myW, oppW);
    sumL += computeNet(myL, oppL);

    if (myL === 0) {
      zeroL++;
      for (let i = 0; i < 8; i++) penL += getPayout(oppL[i]);
    }
  }

  const evW = sumW / nSims;
  const evL = sumL / nSims;

  return {
    value: evW - evL,
    evWin: evW,
    evLose: evL,
    baseline: evW / 9 + evL * 8 / 9,
    pZeroLose: zeroL / nSims,
    avgPenalty: zeroL > 0 ? penL / zeroL : 0,
  };
}

// ═══════════════════════════════════════════════
// VALIDATION
// ═══════════════════════════════════════════════
function parseOpp(str) {
  if (!str.trim()) return new Array(8).fill(0);
  const parts = str.split(/[,\s]+/).filter(s => s.length > 0).map(Number);
  if (parts.some(isNaN)) return null;
  if (parts.length > 8) return null;
  while (parts.length < 8) parts.push(0);
  parts.sort((a, b) => b - a);
  return parts;
}

function validate() {
  const el = document.getElementById('validation');
  const my = parseInt(document.getElementById('in-my').value) || 0;
  const remain = parseInt(document.getElementById('in-remain').value) || 0;
  const opp = parseOpp(document.getElementById('in-opp').value);
  const dbl = document.getElementById('in-double').checked;
  const sqPerHand = dbl ? 2 : 1;

  if (opp === null) {
    el.className = 'validation err';
    el.textContent = 'Invalid opponent counts — use numbers separated by commas';
    return false;
  }

  const oppTotal = opp.reduce((a, b) => a + b, 0);
  const dealt = my + oppTotal;
  const oppsAt0 = opp.filter(x => x === 0).length;
  const totalAt0 = (my === 0 ? 1 : 0) + oppsAt0;

  if (my < 0 || my > 12) { el.className = 'validation err'; el.textContent = 'Your squids must be 0-12'; return false; }
  if (remain < 1 || remain > 11) { el.className = 'validation err'; el.textContent = 'Hands remaining must be 1-11'; return false; }
  if (opp.some(x => x < 0)) { el.className = 'validation err'; el.textContent = 'Opponent counts cannot be negative'; return false; }
  if (dealt > 12) { el.className = 'validation err'; el.textContent = `Too many squids dealt: ${dealt}/12`; return false; }

  // Check dealt + remaining squids consistency
  const doubleInFuture = (dealt < 2) && !dbl;
  const futureSquids = sqPerHand + (remain - 1) + (doubleInFuture ? 1 : 0);
  if (dealt + futureSquids > TOTAL_SQUIDS) {
    el.className = 'validation err';
    el.textContent = `Inconsistent: ${dealt} dealt + ${futureSquids} remaining = ${dealt + futureSquids} > 12 total squids`;
    return false;
  }

  // Warn if game should already be over
  if (totalAt0 === 1) {
    el.className = 'validation warn';
    el.textContent = `Game already ended: only 1 player at 0 squids (early termination rule)`;
    return true;
  }
  if (totalAt0 === 0) {
    el.className = 'validation warn';
    el.textContent = `No players at 0 — game value is $0 for everyone (no losers)`;
    return true;
  }

  // Warn about double hand
  let extra = '';
  if (dealt < 2 && !dbl) {
    extra = ' | Note: double hand (hand 1) not yet played — check box or one future hand is auto-double';
  }

  el.className = 'validation ok';
  el.textContent = `${dealt}/12 dealt · ${remain} hands left · ${totalAt0} players at 0${extra}`;
  return true;
}

// ═══════════════════════════════════════════════
// CALCULATOR
// ═══════════════════════════════════════════════
function runCalc() {
  if (!validate()) return;

  const my = parseInt(document.getElementById('in-my').value) || 0;
  const remain = parseInt(document.getElementById('in-remain').value) || 1;
  const opp = parseOpp(document.getElementById('in-opp').value);
  const dbl = document.getElementById('in-double').checked;
  const sqPerHand = dbl ? 2 : 1;

  const btn = document.getElementById('calc-btn');
  const status = document.getElementById('calc-status');
  btn.disabled = true;
  status.textContent = 'Running 200k sims (early termination)...';

  setTimeout(() => {
    const t0 = performance.now();
    const r = simulate(my, opp, remain, sqPerHand);
    const ms = Math.round(performance.now() - t0);

    btn.disabled = false;
    status.textContent = `Done in ${ms}ms`;

    renderResults(r, my, opp, remain, sqPerHand);
  }, 30);
}

function renderResults(r, mySq, opp, remain, sqPerHand) {
  const el = document.getElementById('results');
  el.style.display = 'block';

  const newSq = mySq + sqPerHand;
  const isThreshold = [3, 5, 7, 9].includes(newSq);
  const thrLabel = {3: '2x', 5: '4x', 7: '6x', 9: '8x'}[newSq] || '';
  const valueClass = r.value >= 0 ? 'pos' : 'neg';

  let interp = '';
  if (r.value >= 6000) interp = 'Massive value — fight for everything';
  else if (r.value >= 3000) interp = 'Very high value — this hand matters enormously';
  else if (r.value >= 1600) interp = 'High value — worth competing hard for';
  else if (r.value >= 800) interp = 'Solid value — meaningful hand';
  else if (r.value >= 300) interp = 'Moderate value — still worth playing';
  else interp = 'Lower value — but every bit counts';

  let html = '';

  if (isThreshold) {
    html += `<div class="threshold-note">
      Winning triggers <b>${thrLabel} multiplier</b> (&rarr;${newSq} squids):
      $${getPayout(mySq).toLocaleString()} &rarr; $${getPayout(newSq).toLocaleString()} payout
    </div>`;
  }

  html += `<div class="result-hero">
    <div class="label">Hand Value (what winning is worth)</div>
    <div class="value ${valueClass}">${fmt(r.value)}</div>
    <div class="interp">${interp}</div>
  </div>`;

  html += `<div class="result-grid">
    <div class="result-cell">
      <div class="label">Baseline EV</div>
      <div class="val ${r.baseline >= 0 ? 'pos' : 'neg'}">${fmt(r.baseline)}</div>
    </div>
    <div class="result-cell">
      <div class="label">EV if Win</div>
      <div class="val ${r.evWin >= 0 ? 'pos' : 'neg'}">${fmt(r.evWin)}</div>
    </div>
    <div class="result-cell">
      <div class="label">EV if Lose</div>
      <div class="val ${r.evLose >= 0 ? 'pos' : 'neg'}">${fmt(r.evLose)}</div>
    </div>
    <div class="result-cell">
      <div class="label">Per Squid</div>
      <div class="val pos">${fmt(r.value / sqPerHand)}</div>
    </div>
  </div>`;

  if (mySq === 0 && r.pZeroLose > 0.01) {
    html += `<div class="penalty-box">
      <div class="title">Zero-Squid Penalty Risk</div>
      If you lose this hand, there's a <b>${(r.pZeroLose * 100).toFixed(1)}%</b> chance
      of ending at 0 squids and paying an average penalty of <b>${fmt(r.avgPenalty)}</b>.
      <br>Winning avoids this risk entirely (you'd have ${sqPerHand}+ squids).
    </div>`;
  }

  el.innerHTML = html;
}

// ═══════════════════════════════════════════════
// TABS
// ═══════════════════════════════════════════════
function switchTab(id) {
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  event.target.classList.add('active');
  document.getElementById('panel-' + id).classList.add('active');
}

// ═══════════════════════════════════════════════
// REFERENCE DATA (from v3 Python simulation with early termination, scaled to $100 base)
// ═══════════════════════════════════════════════
const SCENARIOS = [
  {id: 1, phase:'EARLY', you:0, opp:'3,1,1,0,0,0,0,0', left:7, value:1399, baseline:-675},
  {id: 2, phase:'EARLY', you:2, opp:'1,1,1,0,0,0,0,0', left:7, value:1234, baseline:1192},
  {id: 3, phase:'EARLY', you:1, opp:'2,1,1,0,0,0,0,0', left:7, value:710, baseline:577},
  {id: 4, phase:'EARLY', you:0, opp:'2,2,1,1,0,0,0,0', left:6, value:1304, baseline:-711},
  {id: 5, phase:'EARLY', you:3, opp:'1,1,1,0,0,0,0,0', left:6, value:1990, baseline:2289},
  {id: 6, phase:'MID',   you:0, opp:'3,2,1,1,0,0,0,0', left:5, value:1548, baseline:-940},
  {id: 7, phase:'MID',   you:2, opp:'2,1,1,1,0,0,0,0', left:5, value:1101, baseline:972},
  {id: 8, phase:'MID',   you:2, opp:'3,1,1,0,0,0,0,0', left:5, value:1372, baseline:1217},
  {id: 9, phase:'MID',   you:4, opp:'1,1,1,0,0,0,0,0', left:5, value:3557, baseline:4057},
  {id:10, phase:'MID',   you:3, opp:'2,1,1,0,0,0,0,0', left:5, value:2053, baseline:2360},
  {id:11, phase:'MID',   you:2, opp:'2,2,1,1,0,0,0,0', left:4, value:1176, baseline:972},
  {id:12, phase:'MID',   you:4, opp:'2,1,1,0,0,0,0,0', left:4, value:4025, baseline:4184},
  {id:13, phase:'MID',   you:5, opp:'1,1,1,0,0,0,0,0', left:4, value:3831, baseline:7215},
  {id:14, phase:'LATE',  you:4, opp:'2,1,1,1,0,0,0,0', left:3, value:3700, baseline:3418},
  {id:15, phase:'LATE',  you:6, opp:'1,1,1,0,0,0,0,0', left:3, value:7511, baseline:10621},
  {id:16, phase:'LATE',  you:2, opp:'3,2,1,1,0,0,0,0', left:3, value:1283, baseline:963},
  {id:17, phase:'LATE',  you:4, opp:'2,2,1,1,0,0,0,0', left:2, value:4334, baseline:3439},
  {id:18, phase:'LATE',  you:6, opp:'2,1,1,0,0,0,0,0', left:2, value:8795, baseline:11189},
  {id:19, phase:'END',   you:6, opp:'2,1,1,1,0,0,0,0', left:1, value:8400, baseline:9333},
  {id:20, phase:'END',   you:4, opp:'3,2,1,1,0,0,0,0', left:1, value:5200, baseline:3378},
];

function populateScenarios() {
  const table = document.getElementById('scenarios-table');
  for (const s of SCENARIOS) {
    const tr = document.createElement('tr');
    const valClass = s.value >= 0 ? 'pos' : 'neg';
    const baseClass = s.baseline >= 0 ? 'pos' : 'neg';
    tr.innerHTML = `<td>${s.id}</td><td>${s.phase}</td><td>${s.you}</td>
      <td style="font-size:0.72rem">[${s.opp}]</td><td>${s.left}</td>
      <td class="num ${valClass}">${fmt(s.value)}</td>
      <td class="num ${baseClass}">${fmt(s.baseline)}</td>`;
    tr.style.cursor = 'pointer';
    tr.title = 'Click to load into calculator';
    tr.addEventListener('click', () => {
      document.getElementById('in-my').value = s.you;
      document.getElementById('in-opp').value = s.opp;
      document.getElementById('in-remain').value = s.left;
      document.getElementById('in-double').checked = false;
      switchTab('calc');
      document.querySelector('[onclick="switchTab(\'calc\')"]').classList.add('active');
      document.querySelector('[onclick="switchTab(\'ref\')"]').classList.remove('active');
      validate();
    });
    table.appendChild(tr);
  }
}

// ═══════════════════════════════════════════════
// INIT
// ═══════════════════════════════════════════════
populateScenarios();
validate();
</script>
</body>
</html>
